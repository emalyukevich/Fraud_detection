# üí≥ Credit Card Fraud Detection ‚Äî Advanced ML Project

–ü—Ä–æ–µ–∫—Ç –ø–æ –≤—ã—è–≤–ª–µ–Ω–∏—é –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **unsupervised learning**, **–∞–Ω—Å–∞–º–±–ª–µ–π –º–æ–¥–µ–ª–µ–π** –∏ **–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Ä–æ–≥–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ø–æ–¥—Ö–æ–¥—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –±–∞–Ω–∫–æ–≤—Å–∫–∏–π use-case.

---

## üìå –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

- üìâ –í—ã—è–≤–∏—Ç—å –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —É—Å–ª–æ–≤–∏—è—Ö —Å–∏–ª—å–Ω–æ–≥–æ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤  
- üîç –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **One-Class SVM** –∫–∞–∫ –æ—Å–Ω–æ–≤—É –¥–ª—è –ø–æ–∏—Å–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π  
- üß† –°–æ–±—Ä–∞—Ç—å **–∞–Ω—Å–∞–º–±–ª—å –º–æ–¥–µ–ª–µ–π** –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π  
- üõ° –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å **–ª–æ–∂–Ω–æ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ (False Negatives)**  
- üß± –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å **–º–æ–¥—É–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É**, –ø—Ä–∏–≥–æ–¥–Ω—É—é –¥–ª—è –¥–µ–ø–ª–æ—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

project-root/
‚îú‚îÄ‚îÄ data/
‚îÇ ‚îú‚îÄ‚îÄ raw/
‚îÇ ‚îî‚îÄ‚îÄ processed/
‚îú‚îÄ‚îÄ notebooks/
‚îÇ ‚îú‚îÄ‚îÄ 01_EDA.ipynb
‚îÇ ‚îú‚îÄ‚îÄ 02_Feature_Engineering.ipynb
‚îÇ ‚îú‚îÄ‚îÄ 03_Baseline_Classification_Model.ipynb
‚îÇ ‚îî‚îÄ‚îÄ 04_Final_Model_Evaluation.ipynb
‚îú‚îÄ‚îÄ src/
‚îÇ ‚îú‚îÄ‚îÄ init.py
‚îÇ ‚îú‚îÄ‚îÄ utils.py
‚îÇ ‚îî‚îÄ‚îÄ models/
‚îÇ ‚îú‚îÄ‚îÄ anomaly_detection.ipynb
‚îÇ ‚îú‚îÄ‚îÄ ensemble.py
‚îÇ ‚îú‚îÄ‚îÄ ensemble_model.joblib
‚îÇ ‚îî‚îÄ‚îÄ oneclasssvm_anomaly_detector.joblib
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ .gitignore

---

## üß† –ú–µ—Ç–æ–¥—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è           | –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã                                             |
|---------------------|----------------------------------------------------------------|
| üìä Exploratory Data Analysis | `Boxplot`, –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π sampling, `UMAP`, –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ |
| üèó Feature Engineering | `StandardScaler`, –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏            |
| üïµ Anomaly Detection | `One-Class SVM`                                                |
| ü§ñ –ú–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ | `KNN`, `RandomForestClassifier`, `Logistic Regression`      |
| üîÅ –ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ     | –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π, –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞                  |
| üìè –ú–µ—Ç—Ä–∏–∫–∏            | `Recall`, `Precision`, `F1`, `ROC-AUC`, `Confusion Matrix`   |

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–µ—Ç—Ä–∏–∫–∞                | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------------------------|----------|
| **Recall (Fraud)**     | 0.82     |
| **Precision (Fraud)**  | 0.86     |
| **F1-score (Fraud)**   | 0.84     |
| **ROC AUC (–æ–±—â–∏–π)**    | 0.96     |
| **False Negatives**    | 13       |
| **False Positives**    | 10       |

> üìå –ú–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å (recall) –∏ –æ—Ç–ª–∏—á–Ω—É—é AUC –¥–∞–∂–µ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ (fraud < 0.2%).

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
git clone https://github.com/your-username/creditcard-fraud-detection.git
cd creditcard-fraud-detection
pip install -r requirements.txt

2. –û–±—Ä–∞–±–æ—Ç–∞–π –¥–∞–Ω–Ω—ã–µ:
jupyter notebook notebooks/02_Feature_Engineering.ipynb

3. –û–±—É—á–∏ –∞–Ω—Å–∞–º–±–ª—å:
jupyter notebook notebooks/03_Baseline_Classification_Model.ipynb

4. –ü—Ä–æ–≤–µ—Ä—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
jupyter notebook notebooks/04_Final_Model_Evaluation.ipynb

## üî≠ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

### üß† –ú–æ–¥–µ–ª–∏ –∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- üéõ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å **—Ç–æ–Ω–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –º–æ–¥–µ–ª–µ–π:
  - `LogisticRegression` ‚Äî `penalty`, `C`, `solver`
  - `KNeighborsClassifier` ‚Äî `n_neighbors`, `weights`, `metric`
  - `RandomForestClassifier` ‚Äî `n_estimators`, `max_depth`, `class_weight`
- üß™ –ü–æ–¥–∫–ª—é—á–∏—Ç—å **GridSearchCV** –∏–ª–∏ `Optuna` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### ‚è± –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- üß© –ü–æ—Å—Ç—Ä–æ–∏—Ç—å **Time-aware –º–æ–¥–µ–ª—å**, —É—á–∏—Ç—ã–≤–∞—é—â—É—é:
  - –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–µ–∂–¥—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ (Time-delta features)
  - –°–µ–∑–æ–Ω–Ω—ã–µ/—Å—É—Ç–æ—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
  - –°–∫–æ–ª—å–∑—è—â–∏–µ –æ–∫–Ω–∞ (`rolling mean`, `lag features`)
- üìà –ü–æ—Å—Ç—Ä–æ–∏—Ç—å **–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤**

### üìä –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å
- üß† –ü–æ–¥–∫–ª—é—á–∏—Ç—å **SHAP** –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏–π –º–æ–¥–µ–ª–∏
- üß™ –î–æ–±–∞–≤–∏—Ç—å **LIME** –¥–ª—è —Ç–æ—á–µ—á–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–π –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö
- üí° –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç—ã "–ø–æ—á–µ–º—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–æ–π?"

### üõ∞ –î–µ–ø–ª–æ–π –∏ API
- üöÄ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å **FastAPI-—Å–µ—Ä–≤–µ—Ä**:
  - –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
  - –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ REST API
  - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ –ª–æ–≥–æ–≤ –≤ Swagger UI

### üßÆ –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞
- üìâ –û–±–Ω–æ–≤–∏—Ç—å —Ñ–æ–∫—É—Å —Å ROC AUC –Ω–∞ **PR AUC** (Precision-Recall Area Under Curve)
- ‚öñ –û—Å–æ–±–µ–Ω–Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ –ø—Ä–∏ **—ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–º –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ –∫–ª–∞—Å—Å–æ–≤**
- üìå –î–æ–±–∞–≤–∏—Ç—å cost-based –º–µ—Ç—Ä–∏–∫–∏: –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ü–µ–Ω–∫–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ FN vs FP

### üè∑ Feature Engineering
- üß¨ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª—å—à–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –±–∞–∑–µ `OneClassSVM`:
  - `is_anomaly` –∫–∞–∫ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–ª–∞–≥
  - `decision_function` –∫–∞–∫ `anomaly_score`
  - `rank` –ø–æ —Å—Ç–µ–ø–µ–Ω–∏ –∞–Ω–æ–º–∞–ª—å–Ω–æ—Å—Ç–∏
- üî¨ –ë–æ–ª–µ–µ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
  - `Time` ‚Äî –≤–≤–µ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ `hour`, `delta_time`, `time_since_last_tx`
  - `Amount` ‚Äî –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, binning

---